#include "src.h"

int main()
{
    printf(" ###############   ##########################  ####                 #############  ##################  ################       ###############     \n");
    printf(" ###############   ##########################  ####                 #############  ##################  ################       ###############     \n");
    printf(" ###               #####             ########  ####                      ####      ####         #####  #####           #####  ###                 \n");
    printf(" ###               #####             ########  ####                      ####      ####         #####  #####           #####  ###                 \n");
    printf(" ###               #####                       ####                      ####      ####         #####  #####                  ###                 \n");
    printf(" ###               #####                       ####                      ####      ####         #####  #####                  ###                 \n");
    printf(" ###               #####                       ####                      ####      ##################  #####                  ###                 \n");
    printf(" ###               #####                       ####                      ####      ##################  ###################    ###############     \n");
    printf(" ###############   #####                       ####                      ####      ####                ###################    ###############     \n");
    printf(" ###############   #####                       ####                      ####      ####                              #####    ###                 \n");
    printf(" ###               #####                       ####                      ####      ####                              #####    ###                 \n");
    printf(" ###               #####                       ####                      ####      ####                              #####    ###                 \n");
    printf(" ###               #####                       ####                      ####      ####                              #####    ###                 \n");
    printf(" ###               #####                       ####                      ####      ####                              #####    ###                 \n");
    printf(" ###               #####            ########   ####                      ####      ####                #####         #####    ###                 \n");
    printf(" ###               #####            ########   ####                      ####      ####                #####         #####    ###                 \n");
    printf(" ###############   #########################   ####################  ############  ####                ##############         ###############     \n");
    printf(" ###############   #########################   ####################  ############  ####                ##############         ###############     \n");

    do
    {
        getLocation();

        char *line = NULL;
        size_t len = 0;
        if (getline(&line, &len, stdin) == -1)
        {
            break;
        }

        line[strcspn(line, "\n")] = 0;

        char **tokens = splitArgument(line);
        char **arguments1 = tokens;
        char **arguments2 = NULL;

        for (int i = 0; tokens[i] != NULL; i++)
        {
            if (strcmp(tokens[i], "|") == 0)
            {
                tokens[i] = NULL;
                arguments2 = &tokens[i + 1];
                break;
            }
        }

        if (arguments2)
        {
            mypipe(arguments1, arguments2);
        }
        else
        {
            execmd(arguments1[0], &arguments1[1]);
        }

        free(tokens);
        free(line);

    } while (1);

    return 0;
}